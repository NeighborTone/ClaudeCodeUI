# [機能名] 実装計画

## 概要

[機能の説明と目的]

例：
- ユーザーがUIから直接ダークモードとライトモードを切り替えられる機能を実装する
- テーマ設定を永続化し、アプリ再起動後も保持する
- 既存のテーマシステムと統合し、全ウィジェットに適用する

## 全体構成

| Phase | 概要 | 推定時間 | チェックポイント数 |
|-------|------|---------|------------------|
| Phase 1 | [フェーズ1の概要] | X日 | Y個 |
| Phase 2 | [フェーズ2の概要] | X日 | Y個 |
| Phase 3 | [フェーズ3の概要] | X日 | Y個 |

例：
| Phase | 概要 | 推定時間 | チェックポイント数 |
|-------|------|---------|------------------|
| Phase 1 | コア層実装（テーマ切り替えロジック） | 0.5日 | 2個 |
| Phase 2 | UI層実装（メニュー、アクション） | 1日 | 3個 |
| Phase 3 | 統合テスト | 0.5日 | 1個 |

## 依存関係

```
Phase 1 → Phase 2 → Phase 3
   ↓
Phase 4
```

例：
```
Phase 1（コア層） → Phase 2（UI層） → Phase 3（統合テスト）
```

または並行実行の場合：
```
Phase 1（基盤） → Phase 2（機能A）
                → Phase 3（機能B） → Phase 4（統合）
```

## クリティカルパス【複数ファイル・フォルダにまたがる場合は必須】

**クリティカルパス**: CP1-1 → CP1-2 → CP2-1 → CP3-1（最長経路）

| チェックポイント | 依存先 | ブロック対象 | クリティカル | 対象ファイル/フォルダ |
|-----------------|--------|-------------|-------------|---------------------|
| CP1-1 | なし | CP1-2 | Yes | `src/core/` |
| CP1-2 | CP1-1 | CP2-1, CP2-2 | Yes | `src/core/` |
| CP2-1 | CP1-2 | CP3-1 | Yes | `src/ui/` |
| CP2-2 | CP1-2 | CP3-1 | No（並列可） | `src/widgets/` |
| CP3-1 | CP2-1, CP2-2 | なし | Yes | `tests/` |

**注意**: クリティカルパス上のタスクの遅延は全体スケジュールに直接影響します。

例（ダークモード切り替え機能）：

**クリティカルパス**: CP1-1 → CP1-2 → CP2-1 → CP2-2 → CP2-3 → CP3-1

| チェックポイント | 依存先 | ブロック対象 | クリティカル | 対象ファイル/フォルダ |
|-----------------|--------|-------------|-------------|---------------------|
| CP1-1 | なし | CP1-2 | Yes | `src/core/settings_manager.py` |
| CP1-2 | CP1-1 | CP2-1 | Yes | `src/ui/themes/` |
| CP2-1 | CP1-2 | CP2-2 | Yes | `src/ui/main_window.py` |
| CP2-2 | CP2-1 | CP2-3 | Yes | `src/ui/main_window.py` |
| CP2-3 | CP2-2 | CP3-1 | Yes | `src/widgets/` |
| CP3-1 | CP2-3 | なし | Yes | `tests/` |

**現在のボトルネック**: なし（未着手）

## 影響範囲

### 変更ファイル（概算）

| レイヤー | ファイル数 | 主な変更 |
|---------|-----------|---------|
| `src/core/**` | X個 | [概要] |
| `src/ui/**` | Y個 | [概要] |
| `src/widgets/**` | Z個 | [概要] |

例：
| レイヤー | ファイル数 | 主な変更 |
|---------|-----------|---------|
| `src/core/**` | 1個 | settings_manager.py にdark_mode設定を追加 |
| `src/ui/**` | 2個 | main_window.py にメニュー追加、themes/にテーマ切り替えロジック |
| `src/widgets/**` | 0個 | 既存ウィジェットは自動的にテーマを反映 |

### 既存機能への影響

- [影響1]
- [影響2]

例：
- 既存のテーマシステム（8テーマ）はそのまま利用可能
- テーマ切り替え時に全ウィジェットが自動的に再描画される
- 設定ファイル（settings.json）に新しいキーが追加される

## リスク・注意点

- [リスク1]: 対策 - [対策内容]
- [リスク2]: 対策 - [対策内容]

例：
- リスク1: テーマ切り替え時にウィジェットの再描画が遅延する可能性
  - 対策: 非同期処理とプログレス表示を検討
- リスク2: 既存テーマとの互換性問題
  - 対策: 全8テーマで動作確認を実施

## 成功基準

- [ ] 全ての機能が動作する
- [ ] 全てのテーマで正しく表示される
- [ ] 既存機能に影響がない
- [ ] パフォーマンス劣化がない
- [ ] 統合テストが全て成功する

例：
- [ ] メニューからダークモード切り替えが可能
- [ ] アプリ再起動後もテーマ設定が保持される
- [ ] 全8テーマで正しく動作する
- [ ] テーマ切り替え時の遅延が1秒以内
- [ ] 既存の補完機能、ファイルツリーに影響がない

## 進捗管理

詳細: `XX_progress.md`

## メモ

- [追加の注意事項]
- [参考リンク]

例：
- PySide6のスタイルシート適用は `setStyleSheet()` を使用
- 既存のテーママネージャー（`src/ui/themes/theme_manager.py`）を拡張

## 引き継ぎ情報【コンテキストクリア後の再開用】

### 再開時の確認事項

1. `XX_progress.md` で現在地を確認
2. 該当フェーズファイルで次のタスクの詳細を確認
3. 検証コマンドで前回の状態を確認

### 主要ファイル一覧

| ファイル/フォルダ | 役割 | 関連チェックポイント |
|------------------|------|---------------------|
| `src/core/` | コアロジック | CP1-1, CP1-2 |
| `src/ui/` | ユーザーインターフェース | CP2-1, CP2-2, CP2-3 |
| `tests/` | テストコード | CP3-1 |

例（ダークモード切り替え機能）：

| ファイル/フォルダ | 役割 | 関連チェックポイント |
|------------------|------|---------------------|
| `src/core/settings_manager.py` | ダークモード設定の永続化 | CP1-1, CP1-2 |
| `src/ui/themes/theme_manager.py` | テーマ切り替えロジック | CP1-2 |
| `src/ui/main_window.py` | メニュー追加、アクション実装 | CP2-1, CP2-2 |
| `src/widgets/` | テーマ適用対象 | CP2-3 |
